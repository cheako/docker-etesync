[uwsgi]
http = :$(ETESYNC_PORT)
chdir = $(ETESYNC_DIRECTORY)
module = etesync_server.wsgi

# Static files for the Django admin interface.
static-map = /static=$(ETESYNC_DIRECTORY)/static

# Static files for the web client.
static-map = /=$(ETESYNC_DIRECTORY)/web
static-index = index.html

static-expires = /* 7776000

# Rewrite all URLs except for the EteSync server API to the web client's index file. The web client
# uses the URL to define its current page, so this rule allows reloading of a specific page from
# the browser.
# The rule also excludes paths with a . character, since those probably reference a specific static
# file from the web client.
route = ^/(?!(api/|api-|admin|(.*\.))).* static:$(ETESYNC_DIRECTORY)/web/index.html

log-master = true
disable-logging = true

harakiri = 60
vacuum = true
